{"ast":null,"code":"import _toConsumableArray from \"/Users/waimansing/Documents/3 Companies/1 KitmanStore/admin-purchase/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/waimansing/Documents/3 Companies/1 KitmanStore/admin-purchase/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/waimansing/Documents/3 Companies/1 KitmanStore/admin-purchase/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/waimansing/Documents/3 Companies/1 KitmanStore/admin-purchase/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/waimansing/Documents/3 Companies/1 KitmanStore/admin-purchase/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/waimansing/Documents/3 Companies/1 KitmanStore/admin-purchase/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/waimansing/Documents/3 Companies/1 KitmanStore/admin-purchase/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/waimansing/Documents/3 Companies/1 KitmanStore/admin-purchase/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/waimansing/Documents/3 Companies/1 KitmanStore/admin-purchase/src/App.js\";\nimport React, { Component } from 'react'; // import {BrowserRouter as Router} from 'react-router-dom'\n\nimport './App.css';\nimport Purchase from \"./components/purchases/purchase\";\nimport Header from \"./components/layout/Header\";\nimport PurchaseAdd from \"./components/purchases/purchase_add\";\nimport Api from \"./components/api/api\";\nimport moment from \"moment\"; // import Api from \"./components/api/api\";\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n    _this.state = {\n      purchase: [],\n      isLoading: false,\n      filterPurchase: []\n    };\n    _this.onRowUpdate = _this.onRowUpdate.bind(_assertThisInitialized(_assertThisInitialized(_this))); // 自己都要update\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getPurchase();\n    } /// List\n\n  }, {\n    key: \"getPurchase\",\n    value: function getPurchase() {\n      var _this2 = this;\n\n      Api.get('purchase').then(function (data) {\n        var filterPurchase = data.data.purchases.map(function (purchase, index) {\n          return {\n            id: purchase.id,\n            index: index + 1,\n            createdAt: moment(new Date()).format('YYYY-MM-DD'),\n            purchaseDate: moment(purchase.purchaseDate).format('YYYY-MM-DD'),\n            provider: purchase.product.provider.name,\n            product: purchase.product.name,\n            quantity: purchase.product.quantity,\n            price_purchase: purchase.product.price_purchase,\n            totalPrice: purchase.product.price_purchase * purchase.product.quantity,\n            currentQuantity: purchase.currentQuantity,\n            marketPrice: purchase.marketPrice,\n            remark: purchase.remark,\n            delete: 'Delete'\n          };\n        });\n\n        _this2.setState({\n          purchase: filterPurchase,\n          filterPurchase: filterPurchase,\n          isLoading: false\n        });\n      }).catch(function (error) {\n        alert(error);\n        console.log('e: ' + error);\n      });\n    } // Update\n\n  }, {\n    key: \"onRowUpdate\",\n    value: function onRowUpdate(fromRow, toRow, updated) {\n      var _this3 = this;\n\n      console.log(\"update from child\");\n      console.log(updated);\n      var rows = this.state.purchase;\n      var requestBody = {};\n\n      var _loop = function _loop(i) {\n        var updatedRow = _objectSpread({}, rows[i], updated);\n\n        console.log(updatedRow);\n        requestBody = {\n          products: updatedRow\n        };\n        Api.patch('purchase/' + updatedRow.id, requestBody).then(function (res) {\n          console.log(res); // update child - 1) update row\n\n          var updatedPurchase = _toConsumableArray(_this3.state.filterPurchase);\n\n          updatedPurchase[fromRow] = updatedRow;\n\n          _this3.setState({\n            filterPurchase: updatedPurchase\n          });\n        }).catch(function (error) {\n          console.log(error);\n          alert(error);\n        });\n      };\n\n      for (var i = fromRow; i <= toRow; i++) {\n        _loop(i);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }), React.createElement(PurchaseAdd, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }), React.createElement(Purchase, {\n        purchase: this.state.filterPurchase,\n        isLoading: this.state.isLoading,\n        onRowUpdate: this.onRowUpdate,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/waimansing/Documents/3 Companies/1 KitmanStore/admin-purchase/src/App.js"],"names":["React","Component","Purchase","Header","PurchaseAdd","Api","moment","App","props","state","purchase","isLoading","filterPurchase","onRowUpdate","bind","getPurchase","get","then","data","purchases","map","index","id","createdAt","Date","format","purchaseDate","provider","product","name","quantity","price_purchase","totalPrice","currentQuantity","marketPrice","remark","delete","setState","catch","error","alert","console","log","fromRow","toRow","updated","rows","requestBody","i","updatedRow","products","patch","res","updatedPurchase"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\n// import {BrowserRouter as Router} from 'react-router-dom'\n\nimport './App.css';\n\nimport Purchase from \"./components/purchases/purchase\";\nimport Header from \"./components/layout/Header\";\nimport PurchaseAdd from \"./components/purchases/purchase_add\";\nimport Api from \"./components/api/api\";\nimport moment from \"moment\";\n\n// import Api from \"./components/api/api\";\n\nclass App extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            purchase: [],\n            isLoading: false,\n            filterPurchase: []\n        }\n        this.onRowUpdate = this.onRowUpdate.bind(this); // 自己都要update\n\n    }\n\n    componentDidMount() {\n        this.getPurchase();\n    }\n\n    /// List\n    getPurchase() {\n        Api.get('purchase')\n            .then(data => {\n                const filterPurchase = data.data.purchases.map((purchase, index) => {\n                    return {\n                        id: purchase.id,\n                        index: index + 1,\n                        createdAt: moment(new Date()).format('YYYY-MM-DD'),\n                        purchaseDate: moment(purchase.purchaseDate).format('YYYY-MM-DD'),\n                        provider: purchase.product.provider.name,\n                        product: purchase.product.name,\n                        quantity: purchase.product.quantity,\n                        price_purchase: purchase.product.price_purchase,\n                        totalPrice: purchase.product.price_purchase * purchase.product.quantity,\n                        currentQuantity: purchase.currentQuantity,\n                        marketPrice: purchase.marketPrice,\n                        remark: purchase.remark,\n                        delete: 'Delete'\n                    }\n                });\n                this.setState({\n                    purchase: filterPurchase,\n                    filterPurchase: filterPurchase,\n                    isLoading: false\n                })\n\n            })\n            .catch(error => {\n                alert(error)\n                console.log('e: ' + error)\n            })\n    }\n\n    // Update\n    onRowUpdate(fromRow, toRow, updated) {\n        console.log(\"update from child\")\n        console.log(updated)\n\n        const rows = this.state.purchase;\n        let requestBody = {}\n\n        for (let i = fromRow; i <= toRow; i++) {\n            const updatedRow = {...rows[i], ...updated}\n            console.log(updatedRow)\n            requestBody = {\n                products: updatedRow\n            }\n            Api.patch('purchase/' + updatedRow.id, requestBody).then((res) => {\n                console.log(res)\n                // update child - 1) update row\n\n                let updatedPurchase = [...this.state.filterPurchase]\n                updatedPurchase[fromRow] = updatedRow\n                this.setState({\n                    filterPurchase: updatedPurchase\n                })\n\n            }).catch(error => {\n                console.log(error)\n                alert(error)\n            })\n        }\n\n    }\n\n    render() {\n        return (\n            <div className=\"App\">\n                <Header/>\n                <PurchaseAdd/>\n\n                {/*onRowUpdate is provided for child to update something*/}\n                <Purchase purchase={this.state.filterPurchase}\n                          isLoading={this.state.isLoading}\n                          onRowUpdate={this.onRowUpdate} />\n            </div>\n        )\n    }\n\n\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}