(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{120:function(e,t,a){},121:function(e,t,a){},172:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),r=a(13),i=a.n(r),c=(a(95),a(49)),l=a(50),u=a(29),s=a(30),d=a(37),p=a(31),h=a(36),m=a(22),f=(a(96),a(97),a(74)),g=a.n(f),v=a(75),y=a(76),b=a.n(y).a.create({baseURL:"http://52.199.253.219:3004/"}),k=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).onGridRowsUpdated=function(e){var t=e.fromRow,n=e.toRow,o=e.updated;Object(c.a)(a.props.purchase)[t].provider!==o.provider&&a.props.onRowUpdate(t,n,o)},a.handleFilterChange=function(e){console.log("filterTerm: "+e.filterTerm),console.log("filter key: "+e.column.key);var t=a.state.purchase;e.filterTerm?(t=t.filter(function(t){if("provider"===e.column.key)return-1!==t.provider.toString().toLowerCase().indexOf(e.filterTerm.toString().toLowerCase());if("product"===e.column.key){var a=t.product.toString().toLowerCase();return console.log("productName: "+a),-1!==a.indexOf(e.filterTerm.toString().toLowerCase())}}),a.setState({filterPurchase:t})):a.setState({filterPurchase:a.state.purchase})},a}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount...")}},{key:"componentDidMount",value:function(){console.log("componentDidMount...")}},{key:"componentWillReceiveProps",value:function(e,t){console.log("componentWillReceiveProps...")}},{key:"componentWillUpdate",value:function(e,t,a){console.log("componentWillUpdate...")}},{key:"componentDidUpdate",value:function(e,t,a){console.log("componentDidUpdate...")}},{key:"onDelete",value:function(e){var t=this;window.confirm("\u786e\u5b9a\u5220\u9664\uff1f")&&b.delete("purchase/"+e.rowId).then(function(e){console.log(e),t.getPurchase()}).catch(function(e){alert(e)})}},{key:"render",value:function(){var e=this,t={resizable:!0},a=[{key:"index",name:"No.",editable:!1,width:50},{key:"purchaseDate",name:"\u65e5\u671f",editable:!0,width:100},{key:"provider",name:"\u4f9b\u5e94\u5546",editable:!0,filterable:!0,width:250},{key:"product",name:"\u5546\u54c1\u540d",editable:!0,filterable:!0,width:250},{key:"quantity",name:"\u6570\u91cf",editable:!0,width:50},{key:"price_purchase",name:"\u5355\u4ef7($HKD)",editable:!0,width:120},{key:"totalPrice",name:"\u603b\u4ef7($HKD)",editable:!1,width:120},{key:"currentQuantity",name:"\u5b58\u91cf",editable:!0,width:50},{key:"marketPrice",name:"\u5b9a\u4ef7($HKD)",editable:!0,width:120},{key:"remark",name:"Remark",editable:!0},{key:"delete",name:"\u64cd\u4f5c",editable:!1,events:{onClick:function(t,a){e.onDelete(a)}}}].map(function(e){return Object(l.a)({},e,t)});return this.props.isLoading?o.a.createElement("p",null,"Loading...."):o.a.createElement("div",null,o.a.createElement("h3",null,"\u91c7\u8d2d\u5217\u8868"),o.a.createElement(g.a,{toolbar:o.a.createElement(v.Toolbar,{enableFilter:!0}),onAddFilter:this.handleFilterChange,columns:a,rowGetter:function(t){return e.props.purchase[t]},rowsCount:this.props.purchase.length,enableCellSelect:!0,minHeight:500,enableCellAutoFocus:!1,onGridRowsUpdated:this.onGridRowsUpdated}))}}]),t}(n.Component);a(120);var w=function(){return o.a.createElement("header",{className:"km-header"},o.a.createElement("title",null,"KitMan Store"),o.a.createElement("p",null,"KitMan Store "))},C=(a(121),a(197)),D=a(198),P=a(89),O=(a(128),a(24)),E=a.n(O),j=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(p.a)(t).call(this))).onCreateAtChange=function(t){console.log("onCreateAtChange: "+E()(t).format("YYYY-MM-DD"));var a=E()(t).format("YYYY-MM-DD");e.setState({createdAt:a,now:t})},e.onProviderChange=function(t){console.log("onProviderChange: "+t.target.value),e.setState({provider:t.target.value})},e.onProductChange=function(t){console.log("onProductChange: "+t.target.value),e.setState({product:t.target.value})},e.onQuantityChange=function(t){console.log("onQuantityChange: "+t.target.value),e.setState({quantity:t.target.value})},e.onPriceChange=function(t){console.log("onPriceChange: "+t.target.value),e.setState({price_purchase:t.target.value})},e.onRemarkChange=function(t){console.log("onRemarkChange: "+t.target.value),e.setState({remark:t.target.value})},e.onSubmit=function(t){return t.preventDefault(),console.log(e.state),e.state.provider?e.state.product?e.state.quantity?e.state.price_purchase?void b.post("purchase",{products:{name:e.state.product,quantity:e.state.quantity,price_purchase:e.state.price_purchase,provider:{name:e.state.provider},remark:e.state.remark,purchaseDate:e.state.createdAt}}).then(function(e){console.log(e),window.location.reload()}).catch(function(e){console.log("e: "+e),alert(e)}):(console.log("price_purchase empty"),void alert("\u4ef7\u683c\u5fc5\u586b")):(console.log("quantity empty"),void alert("\u6570\u91cf\u5fc5\u586b")):(console.log("product empty"),void alert("\u5546\u54c1\u540d\u5fc5\u586b")):(console.log("provider empty"),void alert("\u4f9b\u5e94\u5546\u5fc5\u586b"))},e.state={createdAt:E()(new Date).format("YYYY-MM-DD"),provider:"",product:"",quantity:"",price_purchase:"",remark:"",now:new Date},e.onCreateAtChange=e.onCreateAtChange.bind(Object(m.a)(Object(m.a)(e))),e}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("h3",null,"\u6dfb\u52a0\u91c7\u8d2d\u8bb0\u5f55"),o.a.createElement("form",{onSubmit:this.onSubmit,className:"form_add"},o.a.createElement(P.a,{selected:this.state.now,onChange:this.onCreateAtChange,dateFormat:"yyyy-MM-dd",isClearable:!0,className:"datePicker add_item",name:"createdAt",margin:"small"}),o.a.createElement(C.a,{id:"filled-required",type:"text",name:"provider",placeholder:"\u4f9b\u5e94\u5546",value:this.state.provider,onChange:this.onProviderChange,className:"add_item"}),o.a.createElement(C.a,{id:"filled-required",type:"text",name:"product",placeholder:"\u5546\u54c1\u540d",value:this.state.product,onChange:this.onProductChange,className:"add_item"}),o.a.createElement(C.a,{id:"filled-required",type:"number",name:"quantity",placeholder:"\u6570\u91cf",value:this.state.quantity,onChange:this.onQuantityChange,className:"add_item_small"}),o.a.createElement(C.a,{id:"filled-required",type:"number",name:"price_purchase",placeholder:"\u5355\u4ef7",value:this.state.price_purchase,onChange:this.onPriceChange,className:"add_item_small"}),o.a.createElement(C.a,{id:"filled-name",type:"text",name:"remark",placeholder:"Remark",value:this.state.remark,onChange:this.onRemarkChange,className:"add_item"}),o.a.createElement(D.a,{size:"medium",color:"primary","aria-label":"Add",type:"submit",name:"submit"},"+")))}}]),t}(n.Component),_=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={purchase:[],isLoading:!1,filterPurchase:[]},a.onRowUpdate=a.onRowUpdate.bind(Object(m.a)(Object(m.a)(a))),a}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getPurchase()}},{key:"getPurchase",value:function(){var e=this;b.get("purchase").then(function(t){var a=t.data.purchases.map(function(e,t){return{id:e.id,index:t+1,createdAt:E()(new Date).format("YYYY-MM-DD"),purchaseDate:E()(e.purchaseDate).format("YYYY-MM-DD"),provider:e.product.provider.name,product:e.product.name,quantity:e.product.quantity,price_purchase:e.product.price_purchase,totalPrice:e.product.price_purchase*e.product.quantity,currentQuantity:e.currentQuantity,marketPrice:e.marketPrice,remark:e.remark,delete:"Delete"}});e.setState({purchase:a,filterPurchase:a,isLoading:!1})}).catch(function(e){alert(e),console.log("e: "+e)})}},{key:"onRowUpdate",value:function(e,t,a){var n=this;console.log("update from child"),console.log(a);for(var o=this.state.purchase,r={},i=function(t){var i=Object(l.a)({},o[t],a);console.log(i),r={products:i},b.patch("purchase/"+i.id,r).then(function(t){console.log(t);var a=Object(c.a)(n.state.filterPurchase);a[e]=i,n.setState({filterPurchase:a})}).catch(function(e){console.log(e),alert(e)})},u=e;u<=t;u++)i(u)}},{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(w,null),o.a.createElement(j,null),o.a.createElement(k,{purchase:this.state.filterPurchase,isLoading:this.state.isLoading,onRowUpdate:this.onRowUpdate}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},90:function(e,t,a){e.exports=a(172)},95:function(e,t,a){},96:function(e,t,a){},97:function(e,t,a){}},[[90,1,2]]]);
//# sourceMappingURL=main.1221810e.chunk.js.map